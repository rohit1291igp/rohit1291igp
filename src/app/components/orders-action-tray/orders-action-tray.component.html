<app-widgets (onConfirmClicked)="confirmYesNo($event)" [wOptions]="{type : 'confirm', data:confirmData}" *ngIf="confirmFlag" [@enterAnimation]></app-widgets>

<div class="image-preview" *ngIf="imagePreviewFlag">
    <div class="modal fade in" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: block; overflow:scroll; background: rgba(0, 0, 0, 0.77); z-index:9999999;" (click)="imagePreview($event)">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" (click)="imagePreview($event, 'ignore')" [ngClass]="{'mHeight' : isMobile, 'cHeight' : !isMobile}">
                <div class="modal-header" style="border-bottom:none;">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="imagePreview($event)"><span aria-hidden="true">×</span></button>
                    <!--<h4 class="modal-title" id="myModalLabel">Modal Header</h4>-->
                </div>
                <div class="modal-body center-align">
                    <img class="img-responsive" src="{{imagePreviewSrc}}" alt="product_img_preview">

                    <!--<p>Some text in the modal.</p>-->
                </div>
                <!--<div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>-->
            </div>
        </div>
    </div>
    <!--<div class="modal-backdrop fade in" (click)="imagePreview($event)"></div>-->
</div>

<div class="" *ngIf="vendorIssueFlag">
    <div class="modal fade in" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: block; overflow:scroll; background: rgba(0, 0, 0, 0.77);" (click)="closePopup($event)">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" (click)="closePopup($event, 'ignore')">
                <div class="modal-header" style="border-bottom:none;">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="closePopup($event)"><span aria-hidden="true">×</span></button>
                    <h4 class="modal-title" id="myModalLabel">Write to IGP</h4>
                </div>


                <div class="modal-body center-align">
                    <div class="form-group">
                         <form (ngSubmit)="f.form.valid && vendorIssueSubmit($event)" #f="ngForm" nonvalidate>
                            <textarea name="vendorIssue" class="form-control custom-control m-top-1" rows="3" style="resize:none" [(ngModel)]="vendorIssueValue.reason" #vendorIssue="ngModel" placeholder="Explain the issue..." required></textarea>
                            <div *ngIf="f.submitted && !vendorIssue.valid" class="help-block theme-red">Please provide vendor issue!</div>
                            <button class="btn btn-primary m-top-1">Submit</button>
                         </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--<div class="modal-backdrop fade in" (click)="imagePreview($event)"></div>-->
</div>

<div class="" *ngIf="statusMessageFlag">

    <div class="modal fade in" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: block; overflow:scroll; background: rgba(0, 0, 0, 0.77);"  (click)="closePopup($event)">


        <div class="modal-dialog modal-lg" [ngClass]="{'popupSize1' : (statusReasonModel.status === 'Rejected' && !isMobile)}">
            <div class="modal-content" (click)="closePopup($event, 'ignore')">
                <div id="cLoader2" class="cloader hide"></div>
                <div class="modal-header" style="border-bottom:none;">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="closePopup($event)"><span aria-hidden="true">×</span></button>
                    <h4 class="modal-title" id="myModalLabel" *ngIf="statusReasonModel.status === 'Confirmed'">Upload Confirm Order Proof</h4>
                    <h4 class="modal-title" id="myModalLabel" *ngIf="statusReasonModel.status === 'Rejected'">Reason for rejection</h4>
                    <h4 class="modal-title" id="myModalLabel" *ngIf="statusReasonModel.status === 'Delivered'">Proof of Delivery</h4>
                    <h4 class="modal-title" id="myModalLabel" *ngIf="statusReasonModel.status === 'OutForDelivery'">Upload product image(s)</h4>
                </div>


                <div class="modal-body center-align" *ngIf="statusReasonModel.status === 'Rejected'">
                    <div class="form-group">
                        <form (ngSubmit)="f.form.valid && statusReasonSubmit($event)" #f="ngForm" nonvalidate>

                            <select name="rejectopt" class="form-control" [(ngModel)]="statusReasonModel.rejectOption" #rejectopt="ngModel" required>
                                <option *ngFor="let reason of rejectReasons" [ngValue]="reason.value" [attr.data-trayOpen]="reason.type">{{reason.name}}</option>
                            </select>

                            <div *ngIf="f.submitted && !rejectopt.valid" class="help-block theme-red">Please select reason for rejection</div>

                            <div *ngIf="statusReasonModel.rejectOption == 'Other'">
                                <textarea name="message" class="form-control custom-control m-top-1" rows="3" style="resize:none" [(ngModel)]="statusReasonModel.message" #message="ngModel" placeholder="Reason for reject" required></textarea>
                                <div *ngIf="f.submitted && !message.valid" class="help-block theme-red">Reject reason is required</div>
                            </div>

                            <div class="rejectStatusDp" *ngIf="statusReasonModel.rejectOption == 'Delivery not possible on given date'">
                                <my-date-picker name="mydate" [options]="myDatePickerOptions" [(ngModel)]="statusReasonModel.mydate" #mydate="ngModel" placeholder="Choose date to Select earliest possible delivery date(optional)"></my-date-picker>
                                <div *ngIf="f.submitted && !mydate.valid" class="help-block theme-red">Please select a date!</div>
                            </div>

                            <div class="m-top-1 left-align" *ngIf="statusReasonModel.rejectOption == 'Product not available'">
                                <textarea name="message" class="form-control custom-control m-top-1" rows="3" style="resize:none" [(ngModel)]="statusReasonModel.message" #message="ngModel" placeholder="Provide details of alternate product if available(optional)"></textarea>
                                <div *ngIf="f.submitted && !message.valid" class="help-block theme-red">Provide details of product not available</div>
                                <!--<div class="bold">Select not available products :-</div>
                                <div *ngFor="let oProd of statusReasonModel.OrderProductsList">
                                    <label>
                                        <input name="chk" type="checkbox"> &nbsp; {{oProd.productName}}
                                    </label>
                                </div>-->
                            </div>

                            <button class="btn btn-primary m-top-1">Reject</button>
                        </form>
                    </div>
                </div>

                <div class="modal-body center-align" *ngIf="statusReasonModel.status === 'Delivered'" style="padding-bottom: 3em;">
                    <div class="form-group">
                        <form (ngSubmit)="f.form.valid && statusReasonSubmit($event)" #f="ngForm" nonvalidate>
                            <input name="recipientName" class="form-control custom-control" [(ngModel)]="statusReasonModel.recipientName" #recipientName="ngModel" placeholder="Recipient's Name" required>
                            <div *ngIf="f.submitted && !recipientName.valid" class="help-block theme-red">Recipient's name is required</div>

                            <textarea name="message" class="form-control custom-control m-top-1" rows="3" style="resize:none" [(ngModel)]="statusReasonModel.recipientComments" #message="ngModel" placeholder="Comments(optional)"></textarea>
                            <div *ngIf="f.submitted && !message.valid" class="help-block theme-red">comment is required</div>

                             <div class="col-sm-12 col-md-12 uploadFileSection">
                                <div class="uploadedFiles relative" *ngFor="let uploadedFile of uploadedFiles;">
                                    <img  src="{{uploadedFile}}" alt="uploadedImages" (click)="imagePreview($event, uploadedFile)" />
                                    <i class="glyphicon glyphicon-trash abs trashImg" (click)="dltUploadedImage($event, uploadedFile)"></i>
                                </div>


                        <!--<div class="uploadedFiles relative">
                            <img  alt="uploadedImages" src="https://s3.amazonaws.com/vendorimageupload/Delivered/820674_516732_1506696792365.png" (click)="imagePreview($event, 'https://s3.amazonaws.com/vendorimageupload/Delivered/820674_516732_1506696792365.png')">
                            <i class="glyphicon glyphicon-trash abs trashImg" (click)="dltUploadedImage($event, 'https://s3.amazonaws.com/vendorimageupload/Delivered/820674_516732_1506696792365.png')"></i>
                        </div>
                        <div class="uploadedFiles relative">
                            <img  alt="uploadedImages" src="https://s3.amazonaws.com/vendorimageupload/Delivered/820674_516732_1506696792365.png">
                            <i class="glyphicon glyphicon-trash abs trashImg" (click)="dltUploadedImage($event, 'https://s3.amazonaws.com/vendorimageupload/Delivered/820674_516732_1506696792365.png')"></i>
                        </div>-->




                                <input name="deliveredStatusFile" class="" type="file"  [(ngModel)]="statusReasonModel.deliveredStatusFile" #deliveredStatusFile="ngModel" (change)="fileChange($event)" placeholder="Upload Delivery Challan" accept=".jpeg, .jpg, .png" multiple />
                                <div class="clearfix"></div>
                        </div>
                        <div *ngIf="f.submitted && !deliveredStatusFile.valid" class="help-block theme-red">Please upload files!</div>
                        <div *ngIf="fileUploadValidationError" class="help-block theme-red">Please upload files!</div>
                        <div *ngIf="fileOversizeValidation" class="help-block theme-red">Maximum file size should be 5MB</div>

                        <button class="btn btn-primary m-top-1">Mark as Delivered</button>
                            <div *ngIf="f.submitted && !message.valid" class="help-block"></div>
                        </form>
                        <div class="d-flex justify-content-center align-items-flex-end">
                            <div style="left: 22em; bottom: 1em; position: absolute;" *ngIf="!trayOpen && !isMobile">
                                <select class="btn-primary" style="max-width: 150px;height: 34px;border-radius: 3px;
                                margin-right: 8px;" (change)="statusReasonSubmit($event, 'AttemptedDelivery', true)">
                                    <option disabled selected>Attempted Delivery</option>
                                    <option *ngFor="let x of notDeliveredReason">{{x.reason}}</option>
                                </select>
                            </div>
                            <!-- <button [matMenuTriggerFor]="attemptedreasonDesktop" class="btn btn-primary m-top-1"
                            style="left: 21em; bottom: 1em; position: absolute;" *ngIf="!trayOpen && !isMobile">
                            Attempted Delivery
                            </button>
                            <mat-menu #attemptedreasonDesktop="matMenu">
                                <ng-container *ngFor="let x of notDeliveredReason" >
                                    <button mat-menu-item (click)="statusReasonSubmit($event, 'AttemptedDelivery')">{{x.reason}}</button>
                                </ng-container>      
                            </mat-menu> -->

                            <!-- <button [matMenuTriggerFor]="attemptedreasonMobile" class="btn btn-primary m-top-1"
                            style="margin-top: 0.7em;" *ngIf="!trayOpen && isMobile">
                            Attempted Delivery 
                            </button> -->
                            <div style="margin-top: 0.7em;" *ngIf="!trayOpen && isMobile">
                            <select class="btn-primary" style="max-width: 142px;
                            height: 34px;font-size: 14px;border-radius: 3px;margin-right: 8px;" (change)="statusReasonSubmit($event, 'AttemptedDelivery', true)">
                                <option disabled selected>Attempted Delivery</option>
                                <option *ngFor="let x of notDeliveredReason">{{x.reason}}</option>
                            </select>
                            </div>
                            
                            <!-- <mat-menu #attemptedreasonMobile="matMenu">
                                <ng-container *ngFor="let x of notDeliveredReason" >
                                    <button mat-menu-item (click)="statusReasonSubmit($event, 'AttemptedDelivery')">{{x.reason}}</button>
                                </ng-container>      
                            </mat-menu> -->
                            
                            <button class="btn btn-primary m-top-1 viewDetailPopupBtn" style="left:33.5em; bottom:1em;" *ngIf="!trayOpen && !isMobile" (click)="toggleTray($event, 'OutForDeliveryView', statusReasonModel.orderId, null)">View Detail</button>
                            <button class="btn btn-primary m-top-1" style="margin-top: 0.7em;" *ngIf="!trayOpen && isMobile" (click)="toggleTray($event, 'OutForDeliveryView', statusReasonModel.orderId, null)">View Detail</button>
                        </div>
                    </div>
                </div>


                <div class="modal-body center-align" *ngIf="statusReasonModel.status === 'OutForDelivery'">
                    <div class="form-group">
                        <form (ngSubmit)="f.form.valid && statusReasonSubmit($event)" #f="ngForm" nonvalidate>

                        <div class="col-sm-12 col-md-12 uploadFileSection">
                            <div class="uploadedFiles relative" *ngFor="let uploadedFile of uploadedFiles">
                            <img src="{{uploadedFile}}" alt="uploadedImages" (click)="imagePreview($event, uploadedFile)" />
                            <i class="glyphicon glyphicon-trash abs trashImg" (click)="dltUploadedImage($event, uploadedFile)"></i>
                        </div>

                        <!--<div class="uploadedFiles relative">
                            <img  alt="uploadedImages" src="https://s3.amazonaws.com/vendorimageupload/Delivered/820674_516732_1506696792365.png" (click)="imagePreview($event, 'https://s3.amazonaws.com/vendorimageupload/Delivered/820674_516732_1506696792365.png')">
                            <i class="glyphicon glyphicon-trash abs trashImg" (click)="dltUploadedImage($event, 'https://s3.amazonaws.com/vendorimageupload/Delivered/820674_516732_1506696792365.png')"></i>
                        </div>
                        <div class="uploadedFiles relative">
                            <img  alt="uploadedImages" src="https://s3.amazonaws.com/vendorimageupload/Delivered/820674_516732_1506696792365.png">
                            <i class="glyphicon glyphicon-trash abs trashImg" (click)="dltUploadedImage($event, 'https://s3.amazonaws.com/vendorimageupload/Delivered/820674_516732_1506696792365.png')"></i>
                        </div>-->


                        <input name="deliveredStatusFile" class="" type="file" (change)="fileChange($event)" placeholder="Upload file" accept=".jpeg, .jpg, .png" multiple />
                        <div class="clearfix"></div>
                    </div>

                    <button class="btn btn-primary m-top-1" [ngClass]="{'markdlvBtn' : !trayOpen}">Mark as Out for delivery</button>
                    <div *ngIf="f.submitted && !deliveredStatusFile.valid" class="help-block theme-red">Please upload files!</div>
                    <div *ngIf="fileUploadValidationError" class="help-block theme-red">Please upload files!</div>
                    <div *ngIf="fileOversizeValidation" class="help-block theme-red">Maximum file size should be 5MB</div>
                    </form>
                    <button class="btn btn-primary m-top-1 viewDetailPopupBtn" *ngIf="!trayOpen" (click)="toggleTray($event, 'OutForDeliveryView', statusReasonModel.orderId, null)">View Detail</button>
                    </div>
                </div>

                <!--<div class="modal-footer">-->
                    <!--<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>-->
                <!--</div>-->
            </div>
        </div>
    </div>
</div>

<div class="" *ngIf="adminActions.adminActionsFlag">
    <div class="modal fade in" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: block; overflow:scroll; background: rgba(0, 0, 0, 0.77);" (click)="closePopup($event)">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" (click)="closePopup($event, 'ignore')">
                <div class="modal-header" style="border-bottom:none;">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="closePopup($event)"><span aria-hidden="true">×</span></button>
                    <h4 class="modal-title" id="myModalLabel" *ngIf="adminActions.adminActionsName === 'email'">Email</h4>
                    <h4 class="modal-title" id="myModalLabel" *ngIf="adminActions.adminActionsName === 'sms'">SMS</h4>
                    <h4 class="modal-title" id="myModalLabel" *ngIf="adminActions.adminActionsName === 'assignChangeVendor'">
                        <ng-container *ngIf="orderByStatus == 'notAlloted'">Assign</ng-container>
                        <ng-container *ngIf="orderByStatus !== 'notAlloted'">Reassign</ng-container>
                        vendor
                    </h4>
                    <h4 class="modal-title" id="myModalLabel" *ngIf="adminActions.adminActionsName === 'changePrice'">
                        Change
                        <ng-container *ngIf="adminActions.adminActionsSubName ==='comp'">Component</ng-container>
                        <ng-container *ngIf="adminActions.adminActionsSubName ==='shipping'">Shipping</ng-container>
                        Price
                    </h4>
                    <h4 class="modal-title" id="myModalLabel" *ngIf="adminActions.adminActionsName === 'changeDeliveryType&Date'">Chage Delivery Type & Date</h4>
                    <h4 class="modal-title" id="myModalLabel" *ngIf="adminActions.adminActionsName === 'cancelRefund'">Cancel Order</h4>
                </div>

                <div class="modal-body center-align" *ngIf="adminActions.adminActionsName === 'email'">
                    <div class="form-group">
                        <form (ngSubmit)="f.form.valid && adminActionsSubmit($event)" #f="ngForm" nonvalidate>
                            <input name="emailSubject" class="form-control custom-control m-top-1 hide" [(ngModel)]="adminActions.adminActionsModel.emailSubject" #emailSubject="ngModel" placeholder="Subject">
                            <textarea name="emailBody" class="form-control custom-control m-top-1" rows="3" style="resize:none" [(ngModel)]="adminActions.adminActionsModel.emailBody" #emailBody="ngModel" placeholder="Email message..." required></textarea>
                            <div *ngIf="f.submitted && !emailBody.valid" class="help-block theme-red">Please provide email content!</div>
                            <div *ngIf="f.submitted && !emailSubject.valid" class="help-block theme-red">Please provide email subject!</div>
                            <button class="btn btn-primary m-top-1">Submit</button>
                        </form>
                    </div>
                </div>

                <div class="modal-body center-align" *ngIf="adminActions.adminActionsName === 'sms'">
                    <div class="form-group">
                        <form (ngSubmit)="f.form.valid && adminActionsSubmit($event)" #f="ngForm" nonvalidate>
                            <textarea name="sms" class="form-control custom-control m-top-1" rows="3" style="resize:none" [(ngModel)]="adminActions.adminActionsModel.sms" #sms="ngModel" placeholder="SMS" required></textarea>
                            <div *ngIf="f.submitted && !sms.valid" class="help-block theme-red">Please provide sms content!</div>
                            <button class="btn btn-primary m-top-1">Submit</button>
                        </form>
                    </div>
                </div>

                <div class="modal-body center-align" *ngIf="adminActions.adminActionsName === 'assignChangeVendor'">
                    <div class="form-group">
                        <form (ngSubmit)="f.form.valid && adminActionsSubmit($event)" #f="ngForm" nonvalidate>

                            <select multiple name="orderProductId" class="form-control" [(ngModel)]="adminActions.adminActionsModel.orderProductId" #orderProductId="ngModel" required>
                                <option *ngFor="let orderProduct of adminActions.adminActionDepData.orderProducts" [ngValue]="orderProduct.orderProductId" [attr.data-orderid]="orderProduct.orderId">{{orderProduct.productName}}</option>
                            </select>

                            <select name="assignChangeVendor" class="form-control m-top-1" [(ngModel)]="adminActions.adminActionsModel.assignChangeVendor" #assignChangeVendor="ngModel" [disabled]="adminActions.adminActionsModel.checkBox" required>
                                <option *ngFor="let vendor of adminActions.adminActionDepData.vendorList" [ngValue]="vendor.Vendor_Id">{{vendor.Vendor_Name}}</option>
                            </select>
                            <div class="assignCheckbox">
                                <input name="chk" [(ngModel)]="adminActions.adminActionsModel.checkBox" type="checkbox"> &nbsp;&nbsp; Select another Vendor
                            </div>

                            <select name="assignChangeAnotherVendor" class="form-control m-top-2" [(ngModel)]="adminActions.adminActionsModel.assignChangeAnotherVendor" #assignChangeAnotherVendor="ngModel" [disabled]="!adminActions.adminActionsModel.checkBox" required>
                                <option *ngFor="let vendor of dropdownData" [ngValue]="vendor.Vendor_Id">{{vendor.Vendor_Name}}</option>
                            </select>

                            <!--<input name="assignChangeVendor" class="form-control custom-control m-top-1" [(ngModel)]="adminActions.adminActionsModel.assignChangeVendor" #assignChangeVendor="ngModel" placeholder="Vendor" required>-->

                            <div *ngIf="f.submitted && !orderProductId.valid" class="help-block theme-red">Please Select Order Product!</div>
                            <div class="checkbox" *ngIf="adminActions.adminActionsModel.checkBox">
                                <div *ngIf="f.submitted && !assignChangeAnotherVendor.valid" class="help-block theme-red">Please Select vendor name!</div>
                            </div>
                            <div class="checkbox" *ngIf="!adminActions.adminActionsModel.checkBox">
                                <div *ngIf="f.submitted && !assignChangeVendor.valid" class="help-block theme-red">Please Select vendor name!</div>
                            </div>
                            <button class="btn btn-primary m-top-1">Submit</button>
                        </form>
                    </div>
                </div>

                <div class="modal-body center-align" *ngIf="adminActions.adminActionsName === 'changePrice'">
                    <div class="form-group">
                        <form (ngSubmit)="adminActionsSubmit($event, {orderProductId : orderProductId.valid, componentId: true, componentPrice : componentPrice.valid, shippingCharge : shippingCharge.valid})" #f="ngForm" nonvalidate>

                            <select name="orderProductId" class="form-control" [(ngModel)]="adminActions.adminActionsModel.orderProductId" #orderProductId="ngModel" (change)="orderProductChange($event,$event.target.value)" required>
                                <option *ngFor="let orderProduct of adminActions.adminActionDepData.orderProducts" [ngValue]="orderProduct.orderProductId">{{orderProduct.productName}}</option>
                            </select>

                            <select *ngIf="adminActions.adminActionsSubName !='shipping'" name="componentId" class="form-control m-top-1" [(ngModel)]="adminActions.adminActionsModel.componentId" #componentId="ngModel" required>
                                <option *ngFor="let orderProductComponent of adminActions.adminActionDepData.orderProductComponents" [ngValue]="orderProductComponent.componentId">{{orderProductComponent.componentName}}</option>
                            </select>

                            <input [ngClass]="{'hide' : !(adminActions.adminActionsSubName === 'comp' || adminActions.adminActionsSubName === 'both')}" name="componentPrice" class="form-control custom-control m-top-1" [(ngModel)]="adminActions.adminActionsModel.componentPrice" #componentPrice="ngModel" placeholder="Component Price" required>
                            <input [ngClass]="{'hide' : !(adminActions.adminActionsSubName === 'shipping' || adminActions.adminActionsSubName === 'both')}" name="shippingCharge" class="form-control custom-control m-top-1" [(ngModel)]="adminActions.adminActionsModel.shippingCharge" #shippingCharge="ngModel" placeholder="Shipping Charge" required>

                            <div *ngIf="f.submitted && !orderProductId.valid " class="help-block theme-red">Please select order product!</div>
                            <div *ngIf="f.submitted && !componentId.valid" class="help-block theme-red">Please select order product component!</div>
                            <div *ngIf="(adminActions.adminActionsSubName === 'comp' || adminActions.adminActionsSubName === 'both') && f.submitted && !componentPrice.valid" class="help-block theme-red">Please provide new component price!</div>
                            <div *ngIf="(adminActions.adminActionsSubName === 'shipping' || adminActions.adminActionsSubName === 'both') && f.submitted && !shippingCharge.valid" class="help-block theme-red">Please provide new shipping price!</div>
                            <button class="btn btn-primary m-top-1">Submit</button>
                        </form>
                    </div>
                </div>

                <div class="modal-body center-align" *ngIf="adminActions.adminActionsName === 'changeDeliveryType&Date'">
                    <div class="form-group">
                        <form (ngSubmit)="adminActionsSubmit($event, {orderProductId : orderProductId.valid, deliveryType: deliveryType.valid, deliveryDate: deliveryDate.valid, deliveryTime: deliveryTime.valid})" #f="ngForm" nonvalidate>
                            <!--<input name="deliveryType" class="form-control custom-control m-top-1" [(ngModel)]="adminActions.adminActionsModel.deliveryType" #deliveryType="ngModel" placeholder="Delivery Type" required>-->

                            <select name="orderProductId" class="form-control" [(ngModel)]="adminActions.adminActionsModel.orderProductId" #orderProductId="ngModel" (change)="orderProductChange($event,$event.target.value)" required>
                                <option *ngFor="let orderProduct of adminActions.adminActionDepData.orderProducts" [ngValue]="orderProduct.orderProductId">{{orderProduct.productName}}</option>
                            </select>

                            <select name="deliveryType" class="form-control m-top-1" [(ngModel)]="adminActions.adminActionsModel.deliveryType" #deliveryType="ngModel" (change)="changeSlots(deliveryType.value)" required>
                                <option *ngFor="let deliveryType of adminActions.adminActionDepData.deliveryTypes" [ngValue]="deliveryType.value">{{deliveryType.name}}</option>
                            </select>

                            <div [ngClass]="{'hide' : !adminActions.adminActionsModel.deliveryType}">
                                <div class="m-top-1"></div>
                                <my-date-picker name="deliveryDate" [options]="myDatePickerOptions" [(ngModel)]="adminActions.adminActionsModel.deliveryDate" #deliveryDate="ngModel" placeholder="Delivery Date" required></my-date-picker>
                            </div>

                            <select name="deliveryTime" class="form-control m-top-1" [(ngModel)]="adminActions.adminActionsModel.deliveryTime" #deliveryTime="ngModel" [ngClass]="{'hide' : (!adminActions.adminActionsModel.deliveryType || adminActions.adminActionsModel.deliveryType == 3 || !adminActions.adminActionsModel.deliveryDate)}" required>
                                <option *ngFor="let deliveryTime of adminActions.adminActionDepData.deliveryTimes" [ngValue]="deliveryTime.value">{{deliveryTime.name}}</option>
                            </select>

                            <div *ngIf="f.submitted && !orderProductId.valid" class="help-block theme-red">Please select order product!</div>
                            <div *ngIf="f.submitted && !deliveryType.valid" class="help-block theme-red">Please select delivery type!</div>
                            <div *ngIf="f.submitted && adminActions.adminActionsModel.deliveryType && !deliveryDate.valid" class="help-block theme-red">Please select delivery date!</div>
                            <div *ngIf="adminActions.adminActionsModel.deliveryType && adminActions.adminActionsModel.deliveryType == 2 && adminActions.adminActionsModel.deliveryDate && f.submitted && !deliveryTime.valid" class="help-block theme-red">Please select delivery time!</div>
                            <button class="btn btn-primary m-top-1">Submit</button>
                        </form>
                    </div>
                </div>

                <div class="modal-body center-align" *ngIf="adminActions.adminActionsName === 'cancelRefund'">
                    <div class="form-group">
                        <form (ngSubmit)="f.form.valid && adminActionsSubmit($event)" #f="ngForm" nonvalidate>

                            <select multiple name="orderProductId" class="form-control" [(ngModel)]="adminActions.adminActionsModel.orderProductId" #orderProductId="ngModel" (change)="orderProductChange($event,$event.target.value)" required>
                                <option *ngFor="let orderProduct of adminActions.adminActionDepData.orderProducts" [ngValue]="orderProduct.orderProductId">{{orderProduct.productName}}</option>
                            </select>

                            <textarea name="cancelComment" class="form-control custom-control m-top-1" rows="3" style="resize:none" [(ngModel)]="adminActions.adminActionsModel.cancelComment" #cancelComment="ngModel" placeholder="Comment" required></textarea>

                            <div *ngIf="f.submitted && !orderProductId.valid" class="help-block theme-red">Please select order product!</div>
                            <div *ngIf="f.submitted && !cancelComment.valid" class="help-block theme-red">Please provide comment!</div>
                            <button class="btn btn-primary m-top-1">Submit</button>
                        </form>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>


<div id="mainOrderSection" class="orders-action" [ngClass]="{'show-tray': trayOpen, 'hide-tray': !trayOpen}" >
<div class="apierror" *ngIf="apierror">{{apierror}}</div>
  <div class="container-fluid orders-view" [ngClass]="{'no-padding':isMobile}">
    <div class="row sidePanelHeader" [ngClass]="{'no-margin':isMobile}">
        <div class="colInline col-sm-1 col-md-1" *ngIf="!isMobile">
            <a href="#" (click)="toggleTray($event, null, null, activeDashBoardDataType)" [attr.data-trayOpen]="trayOpen">
              <i class="glyphicon glyphicon-remove close-tray"></i>
            </a>
        </div>

        <div class="colInline col-sm-11 col-md-11 " [ngClass]="{'no-padding':!isMobile}">
            <p class="text-bold ">
                <span *ngIf="!orderByStatus">Order Information<span *ngIf="sidePanelData && sidePanelData[0]">({{sidePanelData[0].orderId}})</span></span>
                <span *ngIf="orderByStatus">
                     <span class="" *ngIf="orderUpdateByTime == 'past'">Past - </span>
                     <span class="" *ngIf="orderByStatus == 'processing'">Processing Orders (To be Processed)</span>
                     <span class="" *ngIf="orderByStatus == 'notAlloted'">Not Alloted Orders (To be alloted)</span>

                     <span class="" *ngIf="orderByStatus == 'Processed'">
                        <ng-container *ngIf="isAdmin">Not confirmed</ng-container>
                        <ng-container *ngIf="!isAdmin">New Orders (To be confirmed)</ng-container>
                     </span>

                     <span class="" *ngIf="orderByStatus == 'Confirmed'">
                          <ng-container *ngIf="isAdmin">Not shipped</ng-container>
                          <ng-container *ngIf="!isAdmin">Confirmed Orders (To be delivered)</ng-container>
                     </span>

                     <span class="" *ngIf="orderByStatus == 'OutForDelivery' || orderByStatus=='OutForDeliveryView' ">
                        <ng-container *ngIf="isAdmin">Not delivered</ng-container>
                        <ng-container *ngIf="!isAdmin">Orders out for delivery</ng-container>
                     </span>

                     <span class="" *ngIf="orderByStatus == 'Shipped'">
                        All orders for today
                     </span>

                    <span class="" *ngIf="orderByStatus == 'AttemptedDelivery'">
                        Not Delivered(Attempted orders)
                    </span>

                    <span class="" *ngIf="orderByStatus == 'ApprovedAttemptedDelivery'">
                        Attempted orders
                    </span>

                </span>
            </p>
            <p class="text-grey no-margin">Total - <span *ngIf="!sidePanelData">0</span><span *ngIf="sidePanelData">{{sidePanelData.length}}</span> Orders</p>

            <div class="pullAll" *ngIf="!isMobile && env.userType == 'vendor'" [ngClass]="{'disableBtn' : !sidePanelData}">
                <app-widgets (onWidgetClickEvent)="printDropDown($event)" [wOptions]="{type : 'dropDown', data:printDropDwonData}"></app-widgets>
                <!--<button type="button" class="btn btn-secondary" (click)="print($event, 'order', null, null, null, 'all')">Print All</button>-->
            </div>
        </div>

      <div class="colInline col-sm-1 col-md-1 pull-right" *ngIf="isMobile">
          <a href="#" (click)="toggleTray($event, null, null, activeDashBoardDataType)" [attr.data-trayOpen]="trayOpen">
             <i class="glyphicon glyphicon-remove close-tray"></i>
          </a>
      </div>

    </div>
    <div class="row sidePanelContent">
        <div *ngIf="!sidePanelData" [ngClass]="{'mob' : isMobile}">
            <div class="col-md-12 order-row" *ngFor="let loaderc of loadercount" style="margin-bottom: 0;">
                    <div class="container-fluid orders-tray" >
                        <div class="row delivery-details">
                            <div class="col-md-8 order-details no-padding">
                                <p>
                                    <span class="order-id">Order IDs: <app-loader></app-loader></span>
                                    <span class="delivery-time">Standard Delivery <app-loader></app-loader></span>
                                </p>
                                <div class="text-bold">Deliver to: <app-loader></app-loader></div>
                                <div class="address">Address - <app-loader></app-loader></div>
                                <div class="contact">CONTACT NUMBER - <app-loader></app-loader></div>
                            </div>
                            <div class="col-md-4 order-actions" *ngIf="!isMobile">
                                <div class="row" *ngIf="!isAdmin">
                                    <div class="btn btn-primary actions-button uppercase text-bold text-black bg-white disableBtn">
                                         Reject
                                    </div>
                                    <div class="btn btn-primary actions-button uppercase text-bold text-white bg-green disableBtn">
                                        Confirm
                                    </div>
                                </div>
                                <div class="row" *ngIf="!isAdmin">
                                    <div class="btn btn-primary actions-button text-bold disableBtn" [ngClass]="{'bg-igp text-white': isAlert, 'bg-grey text-black': !isAlert}">
                                        Print Order
                                    </div>
                                    <div class="btn btn-primary actions-button text-bold disableBtn" [ngClass]="{'bg-igp text-white': isAlert, 'bg-grey text-black': !isAlert}">
                                        Print Message
                                    </div>
                                </div>

                                <div class="row order-actions-cont comm" *ngIf="isAdmin && orderByStatus !== 'processing' ">
                                    <div class="actions-button text-bold text-center disableBtn" >
                                        <i class="glyphicon glyphicon-envelope" title="Send Email"></i>
                                    </div>
                                    <div class="actions-button text-bold text-center disableBtn" >
                                         <i class="glyphicon glyphicon-phone" title="Send SMS"></i>
                                    </div>
                                    <div class="actions-button text-bold text-center disableBtn" >
                                        <i class="glyphicon glyphicon-headphones" title="Call"></i>
                                    </div>
                                </div>

                                <div class="row order-actions-cont" *ngIf="isAdmin && orderByStatus !== 'processing'">

                                    <div class="btn btn-primary actions-button text-bold disableBtn">
                                        <ng-container *ngIf="orderByStatus == 'notAlloted'">Assign</ng-container>
                                        <ng-container *ngIf="orderByStatus !== 'notAlloted'">Reassign</ng-container>
                                    </div>

                                    <div class="changeActions dropdown" style="width:48.5%; display:inline-block;">
                                        <div class="btn btn-primary actions-button text-bold dropdown-toggle disableBtn" style="width:100%;">
                                            Change <i class="glyphicon glyphicon-triangle-bottom"></i>
                                        </div>
                                        <div class="dropdown-menu"  style="display:block; margin-top:-0.3em;"  *ngIf="order && order.changeActionsFlag">
                                            <a class="dropdown-item" href="#">Price</a>
                                            <a class="dropdown-item" href="#">Delivery Type & Date</a>
                                        </div>
                                    </div>

                                    <div class="btn btn-primary actions-button text-bold oLog disableBtn" >
                                        Log
                                    </div>

                                    <div class="btn btn-primary actions-button text-bold disableBtn">
                                        Cancel Order
                                    </div>


                                </div>

                               <!-- <div class="row">
                                    <div class="btn btn-primary actions-button text-bold">
                                        Order Instruction
                                    </div>
                                </div>-->
                              <!--<div class="row">
                                  <div class="btn btn-primary actions-button text-bold text-white bg-black disableBtn">
                                      Price Change Request
                                  </div>
                                  &lt;!&ndash;<div class="btn btn-primary actions-button text-bold text-white bg-black">
                                        Other
                                  </div>&ndash;&gt;
                              </div>-->
                        </div>
            </div>
            <div class="row">
                <p><span class="text-bold">Product Name:</span> <span class="uppercase text-igp"><app-loader></app-loader></span></p>

                <div class="col-md-12 product-holder noBtBorder no-padding no-margin">
                    <div class="row">
                        <div class="col-md-12 no-padding comp1">
                            <span>
                               <div class="product-main relative bg-loader" style="width:12em;">
                                    <div class="price-display"></div>
                               </div>
                               <div class="equal-sign table-inline-display">
                                    <div class="table-cell-display v-align-middle">=</div>
                                </div>
                            </span>
                            <span>
                                <div class="product-component relative bg-loader" style="width:7em;">
                                     <div class="component-quantity center-align"></div>
                                     <div class="component-name center-align"></div>
                                     <div class="price-display" ></div>
                                    <div class="price-display" ></div>
                                </div>
                                <div class="table-inline-display plus-sign">
                                    <div class="table-cell-display v-align-middle">+</div>
                                </div>
                            </span>

                             <span>
                                <div class="product-component relative bg-loader" style="width:7em;">
                                    <div class="component-quantity center-align"></div>
                                    <div class="component-name center-align"></div>
                                    <div class="price-display" ></div>
                                    <div class="price-display" ></div>
                                </div>
                                <div class="table-inline-display plus-sign">
                                    <div class="table-cell-display v-align-middle">+</div>
                                </div>
                            </span>

                            <span>
                                <div class="product-component relative bg-loader" style="width:7em;">
                                    <div class="component-quantity center-align"></div>
                                    <div class="component-name center-align"></div>
                                    <div class="price-display" ></div>
                                    <div class="price-display" ></div>
                                </div>
                                <div class="table-inline-display plus-sign">
                                    <div class="table-cell-display v-align-middle">+</div>
                                </div>
                            </span>

                            <span>
                                <div class="product-component relative bg-loader" style="width:7em;">
                                    <div class="component-quantity center-align"></div>
                                    <div class="component-name center-align"></div>
                                    <div class="price-display" ></div>
                                    <div class="price-display" ></div>
                                </div>
                                <div class="table-inline-display plus-sign">
                                    <div class="table-cell-display v-align-middle">+</div>
                                </div>
                            </span>

                            <span>
                                <div class="product-component relative bg-loader" style="width:7em;">
                                    <div class="component-quantity center-align"></div>
                                    <div class="component-name center-align"></div>
                                    <div class="price-display" ></div>
                                    <div class="price-display" ></div>
                                </div>
                                <!--<div class="table-inline-display plus-sign">
                                    <div class="table-cell-display v-align-middle">+</div>
                                </div>-->
                            </span>
                        </div>
                    </div>
                </div>


                <div class="col-md-4"*ngIf="isMobile">
                    <ng-container *ngIf="!isAdmin">
                        <div class="row">
                            <div class="btn btn-primary actions-button uppercase text-bold text-black bg-white disableBtn" style="width:100%; box-shadow: 0 1px 3px #888888;">
                                Reject
                            </div>
                            <div class="btn btn-primary actions-button uppercase text-bold text-white bg-green disableBtn" style="width:100%;">
                                Confirm
                            </div>
                        </div>
                        <div class="row">
                            <div style="width:49.5%;" class="btn btn-primary actions-button text-bold disableBtn"
                                [ngClass]="{'bg-igp text-white': isAlert, 'bg-grey text-black': !isAlert}">
                                Print Order
                            </div>
                            <div style="width:49.5%;" class="btn btn-primary actions-button text-bold disableBtn"
                            [ngClass]="{'bg-igp text-white': isAlert, 'bg-grey text-black': !isAlert}">
                            Print Message
                            </div>
                        </div>
                    </ng-container>

                    <ng-container *ngIf="isAdmin">
                    <div class="row order-actions-cont comm" *ngIf="isAdmin && orderByStatus !== 'processing' ">
                    <div class="actions-button text-bold text-center disableBtn">
                    <i class="glyphicon glyphicon-envelope" title="Send Email"></i>
                    </div>
                    <div class="actions-button text-bold text-center disableBtn">
                    <i class="glyphicon glyphicon-phone" title="Send SMS"></i>
                    </div>
                    <div class="actions-button text-bold text-center disableBtn">
                    <i class="glyphicon glyphicon-headphones" title="Call"></i>
                    </div>
                    </div>

                    <div class="row order-actions-cont" *ngIf="isAdmin && orderByStatus !== 'processing'">

                    <div class="btn btn-primary actions-button text-bold disableBtn">
                    <ng-container *ngIf="orderByStatus == 'notAlloted'">Assign</ng-container>
                    <ng-container *ngIf="orderByStatus !== 'notAlloted'">Reassign</ng-container>
                    </div>

                    <div class="changeActions dropdown" style="width:48.5%; display:inline-block;">
                        <div class="btn btn-primary actions-button text-bold dropdown-toggle disableBtn" style="width:100%;" id="dropdownMenuButton">
                        Change <i class="glyphicon glyphicon-triangle-bottom"></i>
                    </div>
                    <div class="dropdown-menu"  style="display:block; margin-top:-0.3em;"  *ngIf="order && order.changeActionsFlag">
                    <a class="dropdown-item" href="#" >Price</a>
                    <a class="dropdown-item" href="#" >Delivery Type & Date</a>
                    </div>
                    </div>

                    <div class="btn btn-primary actions-button text-bold oLog disableBtn">
                    Log
                    </div>

                    <div class="btn btn-primary actions-button text-bold disableBtn">
                    Cancel Order
                    </div>
                    </div>
                    </ng-container>


              </div>

            </div>
            </div>
            </div>
        </div>
        <div *ngIf="sidePanelData">
            <div  id="order-{{order.orderId}}" class="col-md-12 order-row" *ngFor="let order of sidePanelData; let orderIndex='index'" style="margin-bottom: 0;" [@anim]="order.state" (click)="changeDd($event, false, orderIndex)" [ngClass]="{'mob' : isMobile, 'slaAlert' : (order.orderProducts[0].alertFlag || order.orderProducts[0].slaFlag)}">
                <div class="triangle-topright" [ngClass]="{'mob' : isMobile, 'redBorder' : order.orderProducts[0].alertFlag, 'greenBorder' : order.orderProducts[0].slaFlag}">
                    <div class="slaAlert-flag abs" *ngIf="order.orderProducts[0].alertFlag">High Alert</div>
                    <div class="slaAlert-flag abs" *ngIf="order.orderProducts[0].slaFlag">Action Required</div>
                </div>


                <!-- Print Template start -->
                    <app-print-template [order]="order" [printType]="'order'"></app-print-template>
                    <app-print-template [order]="order" [printType]="'orderMessage'"></app-print-template>
                <!-- Print Template end -->
                <div class="container-fluid orders-tray">
                  <div class="row delivery-details">
                    <div class="col-md-8 order-details no-padding" >
                      <p>
                        <span class="order-id">
                            Order ID: {{order.orderId}}
                        </span>

                        <span>
                            <span class="" *ngIf="order.orderProducts[0].ordersProductStatus == 'Processed'">(New)</span>
                            <span class="" *ngIf="order.orderProducts[0].ordersProductStatus == 'Confirmed'">(Confirmed)</span>
                            <span class="" *ngIf="order.orderProducts[0].ordersProductStatus == 'Rejected'">(Rejected)</span>
                            <span class="" *ngIf="order.orderProducts[0].ordersProductStatus == 'OutForDelivery'">(Out for Delivery)</span>
                            <span class="" *ngIf="order.orderProducts[0].ordersProductStatus == 'Shipped'">(Delivered)</span>
                        </span>
                        <!--<span class="delivery-time">Same Day Delivery 12/4/17 2:00 PM</span>-->
                          <span class="dtm" *ngIf="order && order.orderProducts[0] && order.orderProducts[0].orderProductExtraInfo">
                              <span class="uppercase delivery-time text-bold" attr.data-dt="{{order.orderProducts[0].orderProductExtraInfo.deliveryDate}}" attr.data-pd="{{order.datePurchased}}" >{{getDeliveryDetail(order.orderProducts[0].orderProductExtraInfo, order.datePurchased)}}</span>
                            <br/><span class="uppercase delivery-time text-bold" >{{order.orderOccasion}}</span>
                          </span>
                         
                        <span *ngIf="deliveryBoyEnabled && order?.orderProducts[0]?.deliveryBoyName" class="delivery-boy">Delivery Boy Name:- {{order?.orderProducts[0]?.deliveryBoyName}}</span>

                      </p>
                      <p *ngIf="isAdmin">Ordered through : {{order.orderSource}}</p>

                     <p class=""  *ngIf="isAdmin && order && order.orderProducts[0] && order.orderProducts[0].vendorName" style="margin-top: -0.5em;">
                        <span class="text-bold">Vendor Name:</span>
                        <span class="uppercase text-igp">
                            {{order.orderProducts[0].vendorName}}
                            <span style="color:#333;" *ngIf="order && order.orderProducts[0] && order.orderProducts[0].fkAssociateId" >({{order.orderProducts[0].fkAssociateId}})</span>
                        </span>
                     </p>

                      <div class="text-bold">Deliver to: {{order.deliveryName}}</div>
                      <div class="address">{{order.addressType}} Address - {{order.deliveryStreetAddress}}, <span *ngIf="order.deliveryStreetAddress2">{{order.deliveryStreetAddress2}},</span>{{order.deliveryCity}}-{{order.deliveryPostcode}}, {{order.deliveryState}}</div>
                      <div class="contact">CONTACT NUMBER - {{order.deliveryMobile}} <span *ngIf="order.deliveryAlternateMobile">,{{order.deliveryAlternateMobile}}</span></div>
                    </div>
                    <div class="col-md-4 order-actions" [ngClass]="{'borderLeft': !isMobile}" *ngIf="!isMobile">

                        <div *ngIf="!isAdmin && deliveryBoyEnabled && getNxtOrderStatus(order.orderProducts[0].ordersProductStatus) === 'OutForDelivery'" class="row order-actions-cont agent-action-btn">
                            <button mat-button mat-raised-button mat-success [matMenuTriggerFor]="menu">
                                <span *ngIf="!order.orderProducts[0].fkUserId">Assign to Agent</span>
                                <span *ngIf="order.orderProducts[0].fkUserId"><i class="fa fa-edit"></i> {{order.orderProducts[0].deliveryBoyName}}</span>
                            </button>

                            <mat-menu #menu="matMenu">
                                <ng-container *ngFor="let x of deliveryBoyList" >
                                    <button mat-menu-item *ngIf="order.orderProducts[0].fkUserId !== x.fkUserId && x.Status" (click)="assignToDeliveryBoy(x, order)">
                                        {{x.Full_Name}}
                                    </button>
                                </ng-container>      
                            </mat-menu>

                            <button mat-button mat-raised-button (click)="openNewDeliveryBoyDialog()">Add Agent</button>

                        </div>  

                      <div class="row order-actions-cont" *ngIf="!isAdmin">
                        <div class="btn  actions-button uppercase text-bold bg-white text-red" [ngClass]="{'disableBtn' : order.orderProducts[0].ordersProductStatus !=='Processed', 'hide' : order.orderProducts[0].ordersProductStatus !=='Processed'}" (click)="updateOrderStatus($event, orderIndex, 'Rejected', order.orderId, order.orderProducts, order.orderProducts[0].orderProductExtraInfo.deliveryDate, order.orderProducts[0].orderProductExtraInfo.deliveryTime)">
                          Reject
                        </div>
                        <!-- *ngIf="getNxtOrderStatus(order.orderProducts[0].ordersProductStatus) !== 'OutForDelivery'"  -->
                        <button *ngIf="deliveryBoyEnabled && getNxtOrderStatus(order.orderProducts[0].ordersProductStatus) !== 'OutForDelivery'" class="btn btn-primary actions-button uppercase text-bold text-white bg-green"
                        [ngClass]="{'disableBtn' : (order.orderProducts[0].ordersProductStatus =='Shipped' && order.orderProducts[0].deliveryStatus === 1) ||
                        (order.orderProducts[0].ordersProductStatus =='Dispatched' && order.orderProducts[0].deliveryStatus === 1) ||
                        (order.orderProducts[0].ordersProductStatus =='Confirmed' && order.deliverWhen !== 'today' && order.deliverWhen !== 'past' && order.deliverWhen !== 'tomorrow' && order.deliverWhen !== 'future')}"
                        (click)="updateOrderStatus($event, orderIndex, getNxtOrderStatus(order.orderProducts[0].ordersProductStatus), order.orderId, order.orderProducts, order.orderProducts[0].orderProductExtraInfo.deliveryDate, order.orderProducts[0].orderProductExtraInfo.deliveryTime)">
                              <span *ngIf="order.orderProducts[0].ordersProductStatus =='Processed'">Confirm</span>
                              <!-- <span *ngIf="order.orderProducts[0].ordersProductStatus =='Confirmed'">Out For Delivery</span> -->
                              <span *ngIf="(order.orderProducts[0].ordersProductStatus =='Shipped' && order.orderProducts[0].deliveryStatus === 0) || order.orderProducts[0].ordersProductStatus =='OutForDelivery' || order.orderProducts[0].ordersProductStatus =='ApprovedAttemptedDelivery' || order.orderProducts[0].ordersProductStatus == 'Partially Dispatched' ">Mark as Delivered</span>
                              <span *ngIf="(order.orderProducts[0].ordersProductStatus =='Shipped' && order.orderProducts[0].deliveryStatus === 1)  || (order.orderProducts[0].ordersProductStatus =='Dispatched' && order.orderProducts[0].deliveryStatus === 1)">Mark as Delivered</span>
                        </button>
                        <button *ngIf="!deliveryBoyEnabled" class="btn btn-primary actions-button uppercase text-bold text-white bg-green"
                        [ngClass]="{'disableBtn' : (order.orderProducts[0].ordersProductStatus =='Shipped' && order.orderProducts[0].deliveryStatus === 1) ||
                        (order.orderProducts[0].ordersProductStatus =='Dispatched' && order.orderProducts[0].deliveryStatus === 1) ||
                        (order.orderProducts[0].ordersProductStatus =='Confirmed' && order.deliverWhen !== 'today' && order.deliverWhen !== 'past' && order.deliverWhen !== 'tomorrow' && order.deliverWhen !== 'future')}"
                        (click)="updateOrderStatus($event, orderIndex, getNxtOrderStatus(order.orderProducts[0].ordersProductStatus), order.orderId, order.orderProducts, order.orderProducts[0].orderProductExtraInfo.deliveryDate, order.orderProducts[0].orderProductExtraInfo.deliveryTime)">
                              <span *ngIf="order.orderProducts[0].ordersProductStatus =='Processed'">Confirm</span>
                              <span *ngIf="order.orderProducts[0].ordersProductStatus =='Confirmed'">Out For Delivery</span>
                              <span *ngIf="(order.orderProducts[0].ordersProductStatus =='Shipped' && order.orderProducts[0].deliveryStatus === 0) || order.orderProducts[0].ordersProductStatus =='OutForDelivery' || order.orderProducts[0].ordersProductStatus =='ApprovedAttemptedDelivery' || order.orderProducts[0].ordersProductStatus == 'Partially Dispatched' ">Mark as Delivered</span>
                              <span *ngIf="(order.orderProducts[0].ordersProductStatus =='Shipped' && order.orderProducts[0].deliveryStatus === 1)  || (order.orderProducts[0].ordersProductStatus =='Dispatched' && order.orderProducts[0].deliveryStatus === 1)">Mark as Delivered</span>
                        </button>
                        
                        <button [matMenuTriggerFor]="attemptedreason" class="btn btn-primary actions-button uppercase text-bold text-white bg-green"
                        *ngIf="(order.orderProducts[0].ordersProductStatus =='Shipped' && order.orderProducts[0].deliveryStatus === 0) || order.orderProducts[0].ordersProductStatus =='OutForDelivery' || order.orderProducts[0].ordersProductStatus == 'Partially Dispatched'">
                            Not Delivered
                        </button>
                        <mat-menu #attemptedreason="matMenu">
                            <ng-container *ngFor="let x of notDeliveredReason" >
                                <button mat-menu-item (click)="updateOrderStatus($event, orderIndex, 'AttemptedDelivery', order.orderId, order.orderProducts, order.orderProducts[0].orderProductExtraInfo.deliveryDate, order.orderProducts[0].orderProductExtraInfo.deliveryTime)">{{x.reason}}</button>
                            </ng-container>      
                        </mat-menu>
                      </div>


                    <div class="row order-actions-cont" *ngIf="!isAdmin">
                        <div class="btn btn-primary actions-button text-bold" [ngClass]="{'bg-igp text-white': isAlert, 'bg-grey text-black': !isAlert}" (click)="print($event, 'order', order.orderId, order.orderProducts[0].orderProductExtraInfo.deliveryDate, order.orderProducts[0].orderProductExtraInfo.deliveryTime, null)">
                            Print Order
                        </div>
                        <div class="btn btn-primary actions-button text-bold" [ngClass]="{'bg-igp text-white': isAlert, 'bg-grey text-black': !isAlert, 'disableBtn' : !order.commments}" (click)="print($event, 'order_message', order.orderId, order.orderProducts[0].orderProductExtraInfo.deliveryDate, order.orderProducts[0].orderProductExtraInfo.deliveryTime, null)">
                            Print Message
                        </div>
                    </div>

                    <div class="row instruction-cont relative no-padding order-actions-cont" *ngIf="!isAdmin">
                        <div class="btn btn-primary actions-button text-bold OIB" *ngIf="order.orderInstruction">
                            Order Instruction
                        </div>
                        <div class="btn btn-primary actions-button text-bold needHelp" (click)="orderLog($event, true, orderIndex)">
                         Help / Instructions
                        </div>

                        <div class="order-instruction-detail" *ngIf="order.orderInstruction">
                            <div class="arrow-up abs"></div>
                            <div style="white-space: -moz-pre-wrap; white-space: -hp-pre-wrap; white-space: -o-pre-wrap; white-space: -pre-wrap; white-space: pre-wrap;"><div [outerHTML]="order.orderInstruction"></div></div>
                        </div>

                    </div>

                    <div class="row order-actions-cont comm" *ngIf="isAdmin && order.orderProducts[0].getOrderProductSubCategory !== 'processing' ">
                        <div class="actions-button text-bold text-center" (click)="adminActionsInit($event, 'email', orderIndex)">
                            <i class="glyphicon glyphicon-envelope" title="Send Email"></i>
                        </div>
                        <div class="actions-button text-bold text-center" (click)="adminActionsInit($event, 'sms', orderIndex)">
                            <i class="glyphicon glyphicon-phone" title="Send SMS"></i>
                        </div>
                        <div class="actions-button text-bold text-center relative" (click)="adminActionsInit($event, 'call', orderIndex)">
                            <i class="glyphicon glyphicon-headphones"></i>
                            <div class="vendorCall">8899220022</div>
                        </div>
                    </div>

                    <div class="row order-actions-cont" *ngIf="isAdmin && order.orderProducts[0].getOrderProductSubCategory !== 'processing'">

                        <div class="btn btn-primary actions-button text-bold" (click)="adminActionsInit($event, 'assignChangeVendor', orderIndex)">
                            <ng-container *ngIf="order.orderProducts[0].getOrderProductSubCategory == 'notAlloted'">Assign</ng-container>
                            <ng-container *ngIf="order.orderProducts[0].getOrderProductSubCategory !== 'notAlloted'">Reassign</ng-container>
                        </div>

                        <div class="changeActions dropdown actions-button no-padding no-margin" style="">
                            <div class="btn btn-primary actions-button text-bold" style="width:100%;" (click)="changeDd($event, null, orderIndex)" id="dropdownMenuButton">
                                Change <i class="glyphicon glyphicon-triangle-bottom"></i>
                            </div>
                            <div class="dropdown-menu"  style="display:block; margin-top:-0.3em;"  *ngIf="order.changeActionsFlag">

                                <div class="text-bold" style="width:100%; padding:0.5em 1em; cursor: pointer;" (click)="changePriceDd($event, null, orderIndex)">
                                    Price <i class="glyphicon glyphicon-triangle-bottom"></i>
                                </div>

                                <div class="dropdown-menu"  style="display:block; top:2em; left:-11.5em;"  *ngIf="order.changePriceActionsFlag">
                                    <a class="dropdown-item" href="#" (click)="adminActionsInit($event, 'changePrice', orderIndex, 'comp')">Component Price</a>
                                    <a class="dropdown-item" href="#" (click)="adminActionsInit($event, 'changePrice', orderIndex, 'shipping')">Shipping Price</a>
                                </div>

                                <a class="dropdown-item" href="#" (click)="adminActionsInit($event, 'changeDeliveryType&Date', orderIndex)">Delivery Type & Date</a>
                            </div>
                        </div>

                        <div class="btn btn-primary actions-button text-bold oLog" (click)="orderLog($event, true, orderIndex)">
                            Instructions
                        </div>

                        <div class="btn btn-primary actions-button text-bold" (click)="adminActionsInit($event, 'cancelRefund', orderIndex)">
                            Cancel Order
                        </div>

                        <div class="btn btn-primary actions-button text-bold" (click)="viewUploadImage($event, true, orderIndex)" *ngIf="chkUploadedImage(orderIndex)">
                            Uploaded Image
                        </div>
<!-- *ngIf="orderByStatus == 'AttemptedDelivery'"-->
                        <div class="btn btn-primary actions-button text-bold" (click)="approveAttemptOrder($event, orderIndex)"  *ngIf="order.orderProducts[0].deliveryAttemptFlag">
                            Reattempt
                        </div>
                        <div class="btn btn-primary actions-button text-bold" (click)="showCustomerDetails(orderIndex)" *ngIf="env.userType == 'admin'">
                                Customer Details
                        </div>
                        <div class="custDetail-{{orderIndex}} hide"> 
                                <div>Name: {{order.customersName}}</div>
                                <div>Mobile: {{order.customersMobile}}</div>
                                <div>Email: {{order.customersEmail}}</div>
                                <div><span>{{order.customersCountry}},{{order.customersCity}}</span></div>
                        </div>
                    </div>

                  </div>

                  </div>

                <div class="orderLogCont">
                  <div class="row" *ngFor="let orderProduct of order.orderProducts; let z='index'">
                    <p class="">
                        <span class="text-bold">Product Name:</span>
                        <!--<a target="_new" href="https://www.igp.com/{{orderProduct.productNameForUrl}}">-->
                            <span class="uppercase text-igp">{{orderProduct.productName}}</span>
                            <span class="" *ngIf="orderProduct.products_code">({{orderProduct.products_code}})  </span>
                        <!--</a>-->
                        <!-- <span class="" style="" *ngIf="orderProduct.personalized"> | <a target="_new" href="http://admin.indiangiftsportal.com/persInfo.php?pid={{orderProduct.productId}}&oid={{order.orderId}}">Download Photo</a></span> -->
                        <span class="" style="" *ngIf="orderProduct.personalized"> | <a href="{{orderProduct.personalizedInfo}}" target="_blank" download>Download Photo</a></span>
                        <br/><span class="text-bold" *ngIf="orderProduct.cakemessage">Name on cake: </span><span *ngIf="orderProduct.cakemessage">{{orderProduct.cakemessage}}</span>
                    </p>
                    <p class="text-bold">{{orderProduct?.orderProductExtraInfo?.attributes.replace("[", "").replace("]", "")}}</p>

                    <div class="col-md-12 product-holder" [ngClass]="{'no-margin' : isMobile, 'noBtBorder' : (z+1 === order.orderProducts.length)}">
                      <div class="row">
                          <div class="col-md-12 no-padding comp1">
                        <!--<div class="col-md-3 no-padding comp1">-->
                           <span>
                                <div class="product-main relative">
                                    <div class="component-eggless prod-img abs" *ngIf="orderProduct.productQuantity>1">X {{orderProduct.productQuantity}}</div>
                                    <img class="product-image clk" src="{{productsURL}}th/{{orderProduct.productImage}}?th={{orderProduct.productUpdateDateTime}}" alt="product_img" (click)="imagePreview($event, productsURL+'l/'+(orderProduct.productImage)+'?th='+orderProduct.productUpdateDateTime)">
                                    <div class="price-display">Rs. {{orderProduct.vendorPrice}}</div>
                                </div>
                                <div class="equal-sign table-inline-display" *ngIf="orderProduct && orderProduct.componentList && orderProduct.componentList.length">
                                   <div class="table-cell-display v-align-middle">=</div>
                                </div>
                           </span>
                          <span *ngFor="let prodComponent of orderProduct.componentList; let i='index'">
                              <div class="product-component relative">
                                  <div class="component-eggless abs" *ngIf="prodComponent.eggless">Eggless</div>
                                <img class="component-image clk" src="{{productsCompURL}}th/{{prodComponent.componentImage}}?th={{prodComponent.timestamp}}" alt="Component_img" (click)="imagePreview($event, productsCompURL+'full/'+(prodComponent.componentImage)+'?th='+prodComponent.timestamp)" (error)="onSrcError($event)">
                                <div class="component-quantity center-align">x {{prodComponent.quantity | number | replace}}</div>
                                <div class="component-name center-align">{{prodComponent.componentName}} </div>
                                <div class="price-display" *ngIf="prodComponent.componentPrice && prodComponent.componentPrice !== 'N/A' && prodComponent.componentName !== 'Adjustment' " style="margin-top: 6px; font-size: 0.80em;">{{prodComponent.componentPrice | number | replace}}x{{prodComponent.quantity | number}}={{prodComponent.componentPrice  * prodComponent.quantity}}</div>
                                <div class="price-display" *ngIf="prodComponent.componentPrice && prodComponent.componentPrice !== 'N/A' && prodComponent.componentName === 'Adjustment'" style="margin-top: 6px; font-size: 0.80em;">Rs. {{prodComponent.componentPrice | number | replace}}</div>
                              </div>
                              <div class="table-inline-display plus-sign" *ngIf="(i+1) !== orderProduct.componentList.length">
                                <div class="table-cell-display v-align-middle">+</div>
                              </div>
                          </span>
                            </div>
                      </div>
                    </div>
                  </div>

                    <div class="row">
                        <div class="col-md-4 pull-left text-bold" [ngClass]="{'no-padding m-b-1' : isMobile}">
                            <div>Net Product Price  <span style="margin-left:0.1em;">
                                <span class="theme-red rightAlignrdNumber" *ngIf="order.vendorOrderTotal" [style.width]="(order.vendorOrderTotal).toString().length < 4 ? '3.5em': (order.vendorOrderTotal).toString().length+'em' ">Rs. <span class="pull-right">{{order.orderNetProductPrice | number : '2.0-0' | replace}}</span></span></span>
                            </div>
                            <div style="margin-top:0.5em;">Delivery Charges <span style="margin-left:0.5em;">  <span class="theme-red rightAlignrdNumber" *ngIf="order.vendorOrderTotal" [style.width]="(order.vendorOrderTotal).toString().length < 4 ? '3.5em': (order.vendorOrderTotal).toString().length+'em' ">  Rs. <span class="pull-right">{{order.vendorDeliveryCharge | number : '2.0-0' | replace}}</span></span></span></div>
                            <div class="" style="margin-top:0.5em;">Total Order Value <span style="margin-left:0.5em;">  <span class="theme-red rightAlignrdNumber" *ngIf="order.vendorOrderTotal" [style.width]="(order.vendorOrderTotal).toString().length < 4 ? '3.5em': (order.vendorOrderTotal).toString().length+'em' ">Rs. <span class="pull-right">{{order.vendorOrderTotal | number : '2.0-0' | replace}}</span></span></span></div>
                            <!--<div class="" style="margin-top:0.5em;">Price Adjustment <span style="margin-left:0;"> - <span class="theme-red">Rs. {{order.priceAdjustment | number : '2.0-0'}}</span></span></div>-->
                        </div>
                        <div class="col-md-4">&nbsp;</div>
                        <div class="col-md-4 text-bold">
                        </div>
                    </div>

                    <div class="orderLogContInner"  [ngClass]="{'slideropen': order.orderLogFlag, 'sliderclosed' : !order.orderLogFlag}" >
                        <div class="pull-right logClosebtn" (click)="orderLog($event, false, orderIndex)"> × </div>
                        <div class="orderLogContInner2">
                            <div class="orderLogHeader">
                              <div class="row">
                                <div class="col-md-6" style="padding: 0 0 0 15px;"  *ngIf="isAdmin">
                                  <p class="tab-title" [ngClass]="{'active-tab': activeTab == 'log'}" (click)="onTabClick('log')">Logs</p>
                                </div>
                                <div class="col-md-6" style="padding: 0 15px 0 0;"  *ngIf="isAdmin">
                                  <p class="tab-title" [ngClass]="{'active-tab': activeTab == 'comms'}" (click)="onTabClick('comms')">Communications / Instructions</p>
                                </div>

                                <div class="col-md-6"  *ngIf="!isAdmin">
                                  <p class="tab-title" [ngClass]="{'active-tab': activeTab == 'comms'}" (click)="onTabClick('comms')">Communications / Instructions</p>
                                </div>
                              </div>
                            </div>

                            <div class="" style="margin-left:48%; margin-top:10%;" *ngIf="!order.orderLogData"><app-loader></app-loader></div>
                          <div *ngIf="(activeTab == 'log') && isAdmin" >
                            <div class="content "
                                 *ngIf="order.orderLogData">
                              <div *ngFor="let log of order.orderLogData">
                                <div class="log-list-item">
                                  {{log.message}}
                                  <p style="text-align: right; font-size: 0.8em; margin: 0">by <span style="font-weight: bold; font-style: italic;">{{log.user}}</span> on <span style="font-weight: bold; font-style: italic;">{{log.date}}</span> at <span style="font-weight: bold; font-style: italic;">{{log.time}}</span></p>
                                </div>
                              </div>
                            </div>
                          </div>

                          <div *ngIf="(activeTab == 'comms')">
                            <div class="content message-content"
                                 *ngIf="order.orderLogData && activeTab == 'comms'">
                              <div  *ngFor="let log of order.orderLogData">
                                <div class="log-list-item" >
                                  <p style="font-size: 0.8em; margin: 0"><span style="font-weight: bold; font-style: italic;">{{log.user}} : </span></p>
                                  {{log.message}}
                                  <p style="text-align: right; font-size: 0.8em; margin: 0">on <span style="font-weight: bold; font-style: italic;">{{log.date}}</span> at <span style="font-weight: bold; font-style: italic;">{{log.time}}</span></p>
                                </div>
                              </div>
                            </div>
                            <div class="text-area-block">
                              <form (ngSubmit)="commForm.form.valid && sendCommunicationMessage($event, order, orderIndex)" #commForm="ngForm" novalidate>
                                <div class="row">
                                  <div class="col-md-10">
                                    <textarea required name="vendorIssue" placeholder="enter instruction/message here" [(ngModel)]="vendorIssueValue.reason" #vendorIssue="ngModel"></textarea>
                                    <div *ngIf="commForm.submitted && !vendorIssue.valid" class="help-block theme-red">Please provide vendor issue!</div>
                                  </div>
                                  <div class="col-md-2 no-padding">
                                    <button type="submit" class="btn btn-primary message-send-btn">Send</button>
                                  </div>
                                </div>
                              </form>
                            </div>
                          </div>
                        </div>
                    </div>

                    <div class="uIContInner"  [ngClass]="{'slideropen': order.uIFlag, 'sliderclosed' : !order.uIFlag}"  *ngIf="isAdmin">
                        <div class="pull-right uICloseBtn" (click)="viewUploadImage($event, false, orderIndex)"> × </div>
                        <div class="uIContInner2">
                            <div class="productImages imageListCont">
                                <div class="caption">Product Images</div>
                                <div class="imageList">
                                    <div class="uploadedFile relative" *ngFor="let orderProduct of order.orderProducts;">
                                        <img  src="{{productsURL}}th/{{orderProduct.productImage}}?th={{orderProduct.productUpdateDateTime}}" alt="productImages" (click)="imagePreview($event, productsURL+'l/'+(orderProduct.productImage)+'?th='+orderProduct.productUpdateDateTime)" />
                                    </div>
                                </div>
                            </div>

                            <div class="ofdImages imageListCont" *ngIf="order.uploadedFilePath.OutForDelivery.length">
                                <div class="caption">Delivered Images</div>
                                <div class="imageList">
                                    <div class="uploadedFile relative" *ngFor="let uploadedFile of order.uploadedFilePath.OutForDelivery;">
                                        <img src="{{uploadedFile}}" alt="uploadedImages" (click)="imagePreview($event, uploadedFile)" />
                                    </div>
                                </div>
                            </div>

                            <div class="deliveredImages imageListCont" *ngIf="order.uploadedFilePath.Delivered.length">
                                <div class="caption">Delivery Proof</div>
                                <div class="imageList">
                                    <div class="uploadedFile relative" *ngFor="let uploadedFile of order.uploadedFilePath.Delivered;">
                                        <img src="{{uploadedFile}}" alt="uploadedImages" (click)="imagePreview($event, uploadedFile)" />
                                     </div>
                                </div>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                    </div>

            </div>


        <div class="col-md-4 order-actions no-padding" *ngIf="isMobile">
            <ng-container *ngIf="!isAdmin">
                <div class="row">

                    <div *ngIf="!isAdmin && deliveryBoyEnabled && getNxtOrderStatus(order.orderProducts[0].ordersProductStatus) === 'OutForDelivery'" class="row order-actions-cont agent-action-btn" style="margin: 0 auto;">
                        <button mat-button mat-raised-button mat-success [matMenuTriggerFor]="menu" style="flex: 1;height: 37px;">
                            <span *ngIf="!order.orderProducts[0].fkUserId">Assign to Agent</span>
                            <span *ngIf="order.orderProducts[0].fkUserId"><i class="fa fa-edit"></i> {{order.orderProducts[0].deliveryBoyName}}</span>
                        </button>

                        <mat-menu #menu="matMenu">
                            <ng-container *ngFor="let x of deliveryBoyList" >
                                <button mat-menu-item *ngIf="order.orderProducts[0].fkUserId !== x.fkUserId && x.Status" (click)="assignToDeliveryBoy(x, order)">
                                    {{x.Full_Name}}
                                </button>
                            </ng-container>      
                        </mat-menu>

                        <button style="flex: 1;height: 37px;" mat-button mat-raised-button (click)="openNewDeliveryBoyDialog()">Add Agent</button>
                    </div> 
                        
                    <div class="btn  actions-button uppercase text-bold bg-white text-red" style="width:100%; box-shadow: 0 1px 3px #888888;" [ngClass]="{'disableBtn' : order.orderProducts[0].ordersProductStatus !=='Processed', 'hide' : order.orderProducts[0].ordersProductStatus !=='Processed'}" (click)="updateOrderStatus($event, orderIndex, 'Rejected', order.orderId, order.orderProducts, order.orderProducts[0].orderProductExtraInfo.deliveryDate, order.orderProducts[0].orderProductExtraInfo.deliveryTime)">
                     Reject
                    </div>
                    
                    <button *ngIf="deliveryBoyEnabled && getNxtOrderStatus(order.orderProducts[0].ordersProductStatus) !== 'OutForDelivery'"  style="width:100%;" class="btn btn-primary actions-button uppercase text-bold text-white bg-green"
                    [ngClass]="{'disableBtn' : (order.orderProducts[0].ordersProductStatus =='Shipped' && order.orderProducts[0].deliveryStatus === 1) ||
                    (order.orderProducts[0].ordersProductStatus =='Dispatched' && order.orderProducts[0].deliveryStatus === 1) ||
                    (order.orderProducts[0].ordersProductStatus =='Confirmed' && order.deliverWhen !== 'today' && order.deliverWhen !== 'past' && order.deliverWhen !== 'tomorrow' && order.deliverWhen !== 'future')}"
                    (click)="updateOrderStatus($event, orderIndex, getNxtOrderStatus(order.orderProducts[0].ordersProductStatus), order.orderId, order.orderProducts, order.orderProducts[0].orderProductExtraInfo.deliveryDate, order.orderProducts[0].orderProductExtraInfo.deliveryTime)">
                    <span *ngIf="order.orderProducts[0].ordersProductStatus =='Processed'">Confirm</span>
                    <span *ngIf="order.orderProducts[0].ordersProductStatus =='Confirmed'">Out For Delivery</span>
                    <span *ngIf="(order.orderProducts[0].ordersProductStatus =='Shipped' && order.orderProducts[0].deliveryStatus === 0) || order.orderProducts[0].ordersProductStatus =='OutForDelivery' || order.orderProducts[0].ordersProductStatus =='ApprovedAttemptedDelivery' || order.orderProducts[0].ordersProductStatus == 'Partially Dispatched'">Mark as Delivered</span>
                    <span *ngIf="(order.orderProducts[0].ordersProductStatus =='Shipped' && order.orderProducts[0].deliveryStatus === 1)  || (order.orderProducts[0].ordersProductStatus =='Dispatched' && order.orderProducts[0].deliveryStatus === 1)">Mark as Delivered</span>
                    </button>

                    <button *ngIf="!deliveryBoyEnabled"  style="width:100%;" class="btn btn-primary actions-button uppercase text-bold text-white bg-green"
                    [ngClass]="{'disableBtn' : (order.orderProducts[0].ordersProductStatus =='Shipped' && order.orderProducts[0].deliveryStatus === 1) ||
                    (order.orderProducts[0].ordersProductStatus =='Dispatched' && order.orderProducts[0].deliveryStatus === 1) ||
                    (order.orderProducts[0].ordersProductStatus =='Confirmed' && order.deliverWhen !== 'today' && order.deliverWhen !== 'past' && order.deliverWhen !== 'tomorrow' && order.deliverWhen !== 'future')}"
                    (click)="updateOrderStatus($event, orderIndex, getNxtOrderStatus(order.orderProducts[0].ordersProductStatus), order.orderId, order.orderProducts, order.orderProducts[0].orderProductExtraInfo.deliveryDate, order.orderProducts[0].orderProductExtraInfo.deliveryTime)">
                    <span *ngIf="order.orderProducts[0].ordersProductStatus =='Processed'">Confirm</span>
                    <span *ngIf="order.orderProducts[0].ordersProductStatus =='Confirmed'">Out For Delivery</span>
                    <span *ngIf="(order.orderProducts[0].ordersProductStatus =='Shipped' && order.orderProducts[0].deliveryStatus === 0) || order.orderProducts[0].ordersProductStatus =='OutForDelivery' || order.orderProducts[0].ordersProductStatus =='ApprovedAttemptedDelivery' || order.orderProducts[0].ordersProductStatus == 'Partially Dispatched'">Mark as Delivered</span>
                    <span *ngIf="(order.orderProducts[0].ordersProductStatus =='Shipped' && order.orderProducts[0].deliveryStatus === 1)  || (order.orderProducts[0].ordersProductStatus =='Dispatched' && order.orderProducts[0].deliveryStatus === 1)">Mark as Delivered</span>
                    </button>

                    <button [matMenuTriggerFor]="attemptedreason2" class="btn btn-primary actions-button uppercase text-bold text-white bg-green"
                        *ngIf="(order.orderProducts[0].ordersProductStatus =='Shipped' && order.orderProducts[0].deliveryStatus === 0) || order.orderProducts[0].ordersProductStatus =='OutForDelivery' || order.orderProducts[0].ordersProductStatus == 'Partially Dispatched'">
                        Attempted Delivery 
                    </button>
                    <mat-menu #attemptedreason2="matMenu">
                        <ng-container *ngFor="let x of notDeliveredReason" >
                            <button mat-menu-item (click)="updateOrderStatus($event, orderIndex, 'AttemptedDelivery', order.orderId, order.orderProducts, order.orderProducts[0].orderProductExtraInfo.deliveryDate, order.orderProducts[0].orderProductExtraInfo.deliveryTime)">{{x.reason}}</button>
                        </ng-container>      
                    </mat-menu>
                </div>

                <div class="row">
                    <div class="btn btn-primary actions-button text-bold" style="width:49.5%;" [ngClass]="{'bg-igp text-white': isAlert, 'bg-grey text-black': !isAlert}" (click)="print($event, 'order', order.orderId, order.orderProducts[0].orderProductExtraInfo.deliveryDate, order.orderProducts[0].orderProductExtraInfo.deliveryTime)">
                        Print Order
                     </div>
                    <div class="btn btn-primary actions-button text-bold" style="width:49.5%;" [ngClass]="{'bg-igp text-white': isAlert, 'bg-grey text-black': !isAlert, 'disableBtn' : !order.commments}" (click)="print($event, 'order_message', order.orderId, order.orderProducts[0].orderProductExtraInfo.deliveryDate, order.orderProducts[0].orderProductExtraInfo.deliveryTime)">
                        Print Message
                    </div>
                </div>

                <div class="row instruction-cont relative no-padding">
                    <div class="col-md-12 no-padding">
                            <div class="col-md-6 no-padding" style="width:49.5%; float:left;" *ngIf="order.orderInstruction">
                                    <div class="btn btn-primary actions-button text-bold" style="width:100%;" >
                                        Order Instruction
                                    </div>
                                    <div class="order-instruction-detail mob">
                                        <div class="arrow-up abs"></div>
                                        <div style="white-space: -moz-pre-wrap; white-space: -hp-pre-wrap; white-space: -o-pre-wrap; white-space: -pre-wrap; white-space: pre-wrap;"><div [outerHTML]="order.orderInstruction"></div></div>
                                    </div>
                            </div>
                            <div class="col-md-6 no-padding">
                                <div class="btn btn-primary actions-button text-bold" style="width:49.5%; margin-left:0.5%;" (click)="vendorIssueOpen($svent, order.orderId, order.orderProducts)">
                                    Need Help?
                                </div>
                            </div>
                    </div>
                </div>
            </ng-container>

            <ng-container *ngIf="isAdmin">
                <div class="row order-actions-cont comm" *ngIf="isAdmin && orderByStatus !== 'processing' ">
                <div class="actions-button text-bold text-center" (click)="adminActionsInit($event, 'email', orderIndex)">
                <i class="glyphicon glyphicon-envelope" title="Send Email"></i>
                </div>
                <div class="actions-button text-bold text-center" (click)="adminActionsInit($event, 'sms', orderIndex)">
                <i class="glyphicon glyphicon-phone" title="Send SMS"></i>
                </div>
                <div class="actions-button text-bold text-center" (click)="adminActionsInit($event, 'call', orderIndex)">
                <i class="glyphicon glyphicon-headphones" title="Call"></i>
                </div>
                </div>

                <div class="row order-actions-cont" *ngIf="isAdmin && orderByStatus !== 'processing'">

                <div class="btn btn-primary actions-button text-bold" (click)="adminActionsInit($event, 'assignChangeVendor', orderIndex)">
                <ng-container *ngIf="orderByStatus == 'notAlloted'">Assign</ng-container>
                <ng-container *ngIf="orderByStatus !== 'notAlloted'">Reassign</ng-container>
                </div>

                <div class="changeActions dropdown" style="width:48.5%; display:inline-block;">
                    <div class="btn btn-primary actions-button text-bold dropdown-toggle" style="width:100%;" (click)="changeDd($event, null, orderIndex)" id="dropdownMenuButton">
                    Change <i class="glyphicon glyphicon-triangle-bottom"></i>
                </div>
                <div class="dropdown-menu"  style="display:block; margin-top:-0.3em;"  *ngIf="order.changeActionsFlag">
                <a class="dropdown-item" href="#" (click)="adminActionsInit($event, 'changePrice', orderIndex)">Price</a>
                <a class="dropdown-item" href="#" (click)="adminActionsInit($event, 'changeDeliveryType&Date', orderIndex)">Delivery Type & Date</a>
                </div>
                </div>

                <div class="btn btn-primary actions-button text-bold oLog" (click)="orderLog($event, true, orderIndex)">
                Log
                </div>

                <div class="btn btn-primary actions-button text-bold" (click)="adminActionsInit($event, 'cancelRefund', orderIndex)">
                Cancel Order
                </div>

                <div class="btn btn-primary actions-button text-bold" (click)="viewUploadImage($event, true, orderIndex)" *ngIf="chkUploadedImage(orderIndex)">
                    Uploaded Image
                </div>

                <div class="btn btn-primary actions-button text-bold" (click)="approveAttemptOrder($event, orderIndex)" *ngIf="orderByStatus == 'AttemptedDelivery'">
                    Reattempt
                </div>

                </div>
            </ng-container>

            <!--<div class="row">
                <div class="btn btn-primary actions-button text-bold" style="width:49.5%;" [ngClass]="{'bg-igp text-white': isAlert, 'bg-grey text-black': !isAlert}" (click)="print($event, 'order', order.orderId, order.orderProducts[0].orderProductExtraInfo.deliveryDate, order.orderProducts[0].orderProductExtraInfo.deliveryTime, null)">
                    Print Order
                </div>
                <div class="btn btn-primary actions-button text-bold" style="width:49.5%;" [ngClass]="{'bg-igp text-white': isAlert, 'bg-grey text-black': !isAlert, 'disableBtn' : !order.commments}" (click)="print($event, 'order_message', order.orderId, order.orderProducts[0].orderProductExtraInfo.deliveryDate, order.orderProducts[0].orderProductExtraInfo.deliveryTime, null)">
                    Print Message
                </div>
            </div>-->
        </div>
                </div>
             </div>
        </div>
    </div>
    <br>
    <ng-container *ngIf="deliveryBoyEnabled">
<!-- Out For Delivery Images -->
        <button *ngIf="sidePanelData && sidePanelData[0]?.uploadedFilePath?.OutForDelivery.length > 0" type="button" (click)="ofdImages = !ofdImages" mat-button mat-raised-button mat-success><ng-container *ngIf="ofdImages">Hide</ng-container><ng-container *ngIf="!ofdImages">Show</ng-container> Out For Delivery Images</button>
        <ng-container *ngIf="sidePanelData && sidePanelData[0]?.uploadedFilePath?.OutForDelivery.length > 0">
            <div class="ofdImages-main-container" [ngClass]="ofdImages ? 'ofdImages-show' :'ofdImages-hide'">
                <mat-card style="max-width: 99%;padding: 10px;">
                    <div class="ofdImages-container">
                        <ng-container *ngFor="let imageSrc of sidePanelData[0]?.uploadedFilePath?.OutForDelivery">
                            <img src="{{imageSrc}}" width="150" height="150">
                        </ng-container>
                    </div>
                </mat-card>
            </div>
        </ng-container>

        <!-- Delivered Images -->
        <button *ngIf="sidePanelData && sidePanelData[0]?.uploadedFilePath?.Delivered.length > 0" type="button" (click)="dImages = !dImages" mat-button mat-raised-button mat-success><ng-container *ngIf="dImages">Hide</ng-container><ng-container *ngIf="!dImages">Show</ng-container> Delivered For Images</button>
            <ng-container *ngIf="sidePanelData && sidePanelData[0]?.uploadedFilePath?.Delivered.length > 0">
                <div class="ofdImages-main-container" [ngClass]="dImages ? 'ofdImages-show' :'ofdImages-hide'">
                    <mat-card style="max-width: 99%;padding: 10px;">
                        <div class="dImages-container">
                            <ng-container *ngFor="let imageSrc of sidePanelData[0]?.uploadedFilePath?.Delivered">
                                <img src="{{imageSrc}}" width="150" height="150">
                            </ng-container>
                        </div>
                    </mat-card>
                </div>
            </ng-container>
    </ng-container>
    
  </div>

</div>

