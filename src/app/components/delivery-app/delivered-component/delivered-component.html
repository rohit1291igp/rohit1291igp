<app-delivery-header [title]="'Mark As Delivered'"></app-delivery-header>

<div class="main-container">
    <!-- Header -->
    <!--Header Ends -->
    <!--Actual Image Section-->
    <mat-card style="margin:8px 0px;">
        <div class="taken-img-header">
            <ng-container *ngIf="uploadedFiles.PImages.length > 0 else noPImages">Actual Product images
            </ng-container>
            <ng-template #noPImages>No Product images</ng-template>
        </div>

        <div class="order-img" *ngIf="uploadedFiles.PImages.length > 0" [ngStyle]="{opacity: loading ? '0.5' : '1'}">
            <ng-container *ngFor="let uploadedFile of uploadedFiles.PImages; let i = index;">
                <div class="uploadedFiles relative" *ngFor="let imgSrc of uploadedFile.orderProducts">
                    <img class="image" id="img{{i}}"
                        src="{{productsURL}}th/{{imgSrc.productImage}}?th={{imgSrc.productUpdateDateTime}}"
                        alt="uploadedImages" width="460" height="200" (click)="imagePreview($event, uploadedFile)"
                        (load)="loaded()" />
                </div>
            </ng-container>

            <div [ngStyle]="{display: loading ? 'flex' : 'none'}" class="spinner">
                <mat-spinner [diameter]="30"></mat-spinner>
            </div>
        </div>
    </mat-card>
    <!--Actual Image Section Ends-->
    <!-- Out For Delivered Image Taken Section -->
    <mat-card style="margin:8px 0px;">
        <div class="taken-img-header">
            <ng-container *ngIf="uploadedFiles.ofdImages.length > 0 else noOfdImage">Out For Delivery images
            </ng-container>
            <ng-template #noOfdImage>No Out For Delivery images</ng-template>
        </div>

        <div class="order-img" *ngIf="uploadedFiles.ofdImages.length > 0" [ngStyle]="{opacity: loading ? '0.5' : '1'}">
            <div class="uploadedFiles relative" *ngFor="let uploadedFile of uploadedFiles.ofdImages; let i = index;">
                <img class="image" id="img{{i}}" src="{{uploadedFile}}" alt="uploadedImages" width="460" height="200"
                    (click)="imagePreview($event, uploadedFile)" (load)="loaded()" />
                <!-- <i class="fa fa-times-circle" (click)="dltUploadedImage($event, uploadedFile)"></i> -->
            </div>
            <div [ngStyle]="{display: loading ? 'flex' : 'none'}" class="spinner">
                <mat-spinner [diameter]="30"></mat-spinner>
            </div>
        </div>
    </mat-card>

    <!-- Out For Delivered Image Taken Section Ends -->
    <!-- Delivered Image Taken Section -->
    <mat-card style="margin:8px 0px;">
        <div class="taken-img-header">
            <ng-container *ngIf="uploadedFiles.dImages.length > 0 else noDImage">Delivered images</ng-container>
            <ng-template #noDImage><span [ngClass]="{'error-notify-element-2':commonError && uploadedFiles.dImages.length == 0}">No Delivered images</span></ng-template>
        </div>
        <div class="order-img" *ngIf="uploadedFiles.dImages.length > 0" [ngStyle]="{opacity: loading ? '0.5' : '1'}">
            <div class="uploadedFiles relative" *ngFor="let uploadedFile of uploadedFiles.dImages; let i = index;">
                <img class="image" id="img{{i}}" src="{{uploadedFile}}" alt="uploadedImages" width="460" height="200"
                    (click)="imagePreview($event, uploadedFile)" (load)="loaded()" />
                <i class="fa fa-times-circle" (click)="dltUploadedImage($event, uploadedFile)"></i>
            </div>
            <div [ngStyle]="{display: loading ? 'flex' : 'none'}" class="spinner">
                <mat-spinner [diameter]="30"></mat-spinner>
            </div>
        </div>
        <!-- Order Photos -->
        <div class="photo-container">
            <div class="photo">
                <label>
                    <input id="fileInput" type="file" [(ngModel)]="statusReasonModel.deliveredStatusFile"
                        #deliveredStatusFile="ngModel" (change)="fileChange($event)" accept="image/*"
                        capture="camera" />
                    Take Photo
                </label>
                <div class="clearfix"></div>
            </div>
        </div>
        <!-- Order Photos Ends -->
    </mat-card>

    <!-- Delivered Image Taken Section Ends -->
    <!-- Delivery Address -->
    <mat-card style="margin: 8px 0px">
        <div class="taken-img-header">Deliver To - </div>
        <div class="receiver-details-container" [ngClass]="{'error-notify-element-1':commonError && !recipientInfo}">
            <button [ngStyle]="{opacity: recipientInfo === 'self' ? '1' : '0.5'}"
                (click)="getRecipientInfo('self')">SELF</button>
            <button [ngStyle]="{opacity: recipientInfo === 'neighbor' ? '1' : '0.5'}"
                (click)="getRecipientInfo('neighbor')">NEIGHBOR</button>
            <button [ngStyle]="{opacity: recipientInfo === 'securitygaurd' ? '1' : '0.5'}"
                (click)="getRecipientInfo('securitygaurd')">SECURITY GUARD</button>
            <button [ngStyle]="{opacity: recipientInfo === 'others' ? '1' : '0.5'}"
                (click)="getRecipientInfo('others')">OTHER</button>
        </div>
        <!-- Delivery Address Ends -->
        <!-- Reciever's Details -->
        <div class="reciever-container">
            <form [formGroup]="myForm">
                <div class="form-row">
                    <div class="input-container">
                        <mat-form-field>
                            <input formControlName="name" matInput placeholder="Recipient name">
                        </mat-form-field>
                    </div>
                </div>

                <div class="form-row">
                    <div class="input-container-full-with">
                        <mat-form-field>
                            <div style="display: flex; align-items: center;">
                                <div>+91</div>
                                <input type="tel" formControlName="phone" matInput>
                            </div>
                        </mat-form-field>
                    </div>
                </div>
            </form>
        </div>
        <!-- Reciever's Details Ends -->
    </mat-card>
    <div *ngIf="commonError" class="errText">{{commomErrorMsg}}</div>
    <div class="delivered-btn">
        <button [ngClass]="{'disable':!(recipientInfo && (uploadedFiles.dImages.length > 0)), 'active': (recipientInfo && (uploadedFiles.dImages.length > 0))}"
            (click)="updateOrder('Delivered')">DELIVERED</button>
        <!-- <a routerLink="/delivery-app/orders-delivered">DELIVERED</a> -->
    </div>
    <div style="clear: both"></div>
</div>